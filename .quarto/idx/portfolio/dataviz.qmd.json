{"title":"Data Visualization","markdown":{"yaml":{"title":"Data Visualization","image":"/files/images/sample-figure.jpg"},"headingText":"Regular plot theme","containsRefs":false,"markdown":"\n```{r setup, include = FALSE, warning = FALSE, message=FALSE}\n\nlibrary(tidyverse)\nlibrary(ggforce)\nlibrary(ggtext)\nlibrary(patchwork)\nlibrary(here)\nlibrary(lubridate)\nlibrary(scales)\n\nbasesize <-  11\n\ntheme_flynn <- function(){ \n  \n  theme_linedraw(base_size = basesize, base_family = \"oswald\") %+replace% \n    \n    theme(plot.title = element_text(face = \"bold\", size = basesize * 1.3, hjust = 0, margin = margin(t = 0, b = 0.2, l = 0, r = 0, unit = \"cm\")),\n          plot.subtitle = element_text(size = basesize, hjust = 0, margin = margin(t = 0.0, b = 0.2, unit = \"cm\")),\n          plot.caption = element_text(face = \"italic\", size = basesize * 0.6, hjust = 1, lineheight = 1, margin = margin(t = 0.2, unit = \"cm\")),\n          panel.border = element_rect(fill = NA, size = 0.2),\n          strip.background = element_rect(fill = \"gray80\", color = \"black\", size = 0.2),\n          strip.text = element_text(size = basesize, color = \"black\", face = \"bold\", margin = margin(t = 0.2, b = 0.2, l = 0.2, r = 0.2, unit = \"cm\")),\n          panel.background = element_rect(size = 0.2),\n          panel.grid.major = element_line(color = \"gray70\", size = 0.15),\n          panel.grid.minor = element_line(color = \"gray90\", size = 0.1),\n          axis.title = element_text(face = \"bold\", size = basesize),\n          axis.title.y = element_text(angle = 90, margin = margin(t = 0, r = 0.2, b = 0, l = 0, unit = \"cm\")),\n          axis.title.x = element_text(margin = margin(t = 0.2, r = 0, b = 0, l = 0, unit = \"cm\")),\n          axis.ticks = element_line(size = 0.1),\n          axis.ticks.length = unit(0.1, \"cm\"),\n          legend.title = element_text(size = basesize, face = \"bold\", hjust = 0, margin = margin(t = 0, b = 0, l = 0, r = 0, unit = \"cm\")),\n          legend.text = element_text(size = basesize, hjust = 0, margin = margin(t = 0, b = 0, l = 0, r = 0, unit = \"cm\")),\n          legend.box.spacing =  unit(0.2, \"cm\"),\n          plot.margin = margin(0.3, 0.3, 0.3, 0.3, unit = \"cm\"))\n}\n\nshowtext::showtext_auto()\n\n```\nCommunicating information clearly and effectively is a critical part of any industry. One of my interests is using data visualization to help clients more effectively understand their data, and to also help them to more effectively communicate with their stakeholders. \n\nBelow you can find examples of data visualization projects that I've worked on over the years.\n\n## Examples\n\nDemonstrating concepts of accuracy and validity for measurement issues.\n\n```{r, echo = FALSE, warning=FALSE,  message=FALSE}\n\nN <- 1e2\n\ncircles <- data.frame(\n  x0 = rep(0, 5),\n  y0 = rep(0, 5),\n  r = seq(0.1, 1, length.out = 5)\n)\n\ndata.av <- tibble(x = rnorm(N, 0, 0.1),\n                  y = rnorm(N, 0, 0.1),\n                  group = \"Valid, Reliable\") \n\ndata.anv <- tibble(x = rnorm(N, 0.5, 0.1),\n                  y = rnorm(N, 0.5, 0.1),\n                  group = \"Not Valid, Reliable\") \n\ndata.nav <- tibble(x = rnorm(N, 0, 0.25),\n                   y = rnorm(N, 0, 0.25),\n                   group = \"Valid, Not Reliable\") \n\ndata.nanv <- tibble(x = rnorm(N, -0.5, 0.25),\n                   y = rnorm(N, -0.6, 0.25),\n                   group = \"Not Valid, Not Reliable\") \n\n\n\nplot.av <- ggplot() +\n  geom_circle(data = circles, aes(x0 = x0, y0 = y0, r = r, fill = r), alpha = 0.4, show.legend = FALSE) +\n  geom_point(data = data.av, aes(x = x, y = y), fill = \"maroon\", alpha = .8, size = 2, pch = 21) +\n  coord_fixed() +\n  theme_void() +\n  theme(title = element_markdown(size = 12, face = \"bold\")) +\n  scale_x_continuous(limits = c(-1.25, 1.25)) +\n  scale_y_continuous(limits = c(-1.25, 1.25)) +\n  labs(title = \"Valid, Reliable\")\n\n\nplot.anv <- ggplot() +\n  geom_circle(data = circles, aes(x0 = x0, y0 = y0, r = r, fill = r), alpha = 0.4, show.legend = FALSE) +\n  geom_point(data = data.anv, aes(x = x, y = y), fill = \"maroon\", alpha = .8, size = 2, pch = 21) +\n  coord_fixed() +\n  theme_void() +\n  theme(title = element_markdown(size = 12, face = \"bold\")) +\n  scale_x_continuous(limits = c(-1.25, 1.25)) +\n  scale_y_continuous(limits = c(-1.25, 1.25)) +\n  labs(title = \"Not Valid, Reliable\")\n\nplot.nav <- ggplot() +\n  geom_circle(data = circles, aes(x0 = x0, y0 = y0, r = r, fill = r), alpha = 0.4, show.legend = FALSE) +\n  geom_point(data = data.nav, aes(x = x, y = y), fill = \"maroon\", alpha = .8, size = 2, pch = 21) +\n  coord_fixed() +\n  theme_void() +\n  theme(title = element_markdown(size = 12, face = \"bold\")) +\n  scale_x_continuous(limits = c(-1.25, 1.25)) +\n  scale_y_continuous(limits = c(-1.25, 1.25)) +\n  labs(title = \"Valid, Not Reliable\")\n\n\nplot.nanv <- ggplot() +\n  geom_circle(data = circles, aes(x0 = x0, y0 = y0, r = r, fill = r), alpha = 0.4, show.legend = FALSE) +\n  geom_point(data = data.nanv, aes(x = x, y = y), fill = \"maroon\", alpha = .8, size = 2, pch = 21) +\n  coord_fixed() +\n  theme_void() +\n  theme(title = element_markdown(size = 12, face = \"bold\")) +\n  scale_x_continuous(limits = c(-1.25, 1.25)) +\n  scale_y_continuous(limits = c(-1.25, 1.25)) +\n  labs(title = \"Not Valid, Not Reliable\")\n\nplot.com <- wrap_plots(plot.av, plot.nav, plot.anv, plot.nanv)\n\nplot.com\n\n```\n\n\nMapping the sulfate levels in Adirondack Lakes (New York) over time.\n\n```{r Adirondack Sulfate Levels Map, echo=FALSE, warning=FALSE, message=FALSE}\n\n# Mapping sulfate levels in New York State\nlake.map <- read.csv(here::here(\"../../Data Files/Adirondack Lake Survey/ALS_SUMMER_SURFACE_CHEM_1984-87.csv\"), skip = 3, stringsAsFactors = FALSE)\n\n                     colnames(lake.map)[3] <- \"Sample Date\"\ncolnames(lake.map)[6] <- \"Sulfate\"\ncolnames(lake.map)[4] <- \"long\"\ncolnames(lake.map)[5] <- \"lat\"\n\nlake.map <- lake.map %>%\n  group_by(PONDNAME, POND) %>% \n  dplyr::summarise(sulfate = mean(`Sulfate`, na.rm = TRUE), \n            lat = mean(lat, na.rm = TRUE), \n            long = mean(-long, na.rm = TRUE)) \n\n\nmap <- map_data(\"state\", region = \"new york\")\n\n\nggplot() +\n  geom_polygon(data = map, aes(x = long, y = lat, group = group), fill = \"gray60\") +\n  geom_point(data = lake.map, aes(x = long, y = lat, colour = sulfate), alpha = .5) +\n  theme_void() +\n  theme(title = element_text(face = \"bold\", size = 14, family = \"Oswald\"),\n        legend.title = element_text(face = \"bold\"), \n        legend.position = c(1.0, 0.5)) +\n  coord_quickmap() +\n  scale_colour_distiller(type = \"seq\", palette = \"Spectral\", direction = -1, limits = c(0,25)) +\n  labs(title = \"Sulfate levels in Adirondack lakes, 1984-1987\",\n       colour = \"Sulfate Level \\n(mg/L)\",\n       caption = \"Data collected from the Adirondack Lake Survey Corporation\")\n```\n\n\nHere are some cross sectional time series data on Adirondack Lake sulfate levels over time.\n\n```{r Adirondack suflate levels over time, echo=FALSE,warning=FALSE,message=FALSE}\n\n# Note I had to rename a complicated column here. Basic rename didn't work, had to use col number.\ndata <- read_csv(here::here(\"../../Data Files/Adirondack Lake Survey/2016-1992_ALTM_WEB.csv\"), skip = 11)\ncolnames(data)[6] <- \"Sample Date\"\ncolnames(data)[8] <- \"Sulfate\"\ncolnames(data)[4] <- \"Station\"\ncolnames(data)[5] <- \"Depth\"\n\n# The date conversation is tricky here\n# The format part has to match the existing format from the imported data (here it's a \".\")\n# The sep line tells it what to convert the separator to\ndata <- data %>% \n  subset(`Station` == 1) %>% \n  mutate(`Sample Date` = as.Date(`Sample Date`, format = \"%Y.%m.%d\", sep = \"-\", origin = \"1970-01-01\"))\n\ndata.1 <- data %>% \n  subset(select = c(\"Sample Date\", \"Sulfate\"))\n\ndata.2 <- read_csv(here::here(\"../../Data Files/Adirondack Lake Survey/ALS_SUMMER_SURFACE_CHEM_1984-87.csv\"), skip = 3)\ncolnames(data.2)[3] <- \"Sample Date\"\ncolnames(data.2)[6] <- \"Sulfate\"\ncolnames(data.2)[4] <- \"long\"\ncolnames(data.2)[5] <- \"lat\"\ndata.2 <- data.2 %>% \n  subset(select = c(\"Sample Date\", \"Sulfate\")) %>% \n  mutate(`Sample Date` = as.Date(`Sample Date`, format = \"%m/%d/%y\", sep = \"-\", origin = \"1970-01-01\"))\n\ndata.combined <- rbind(data.1, data.2)\n\n\n# Combined Point data\nggplot(data = data.combined, aes(x = `Sample Date`, y = Sulfate)) +\n  geom_point(alpha = .2) +\n  geom_smooth(method = \"lm\", formula = y ~ splines::bs(x, 3), se = FALSE) +\n  geom_vline(xintercept = as.Date(\"1990-11-15\"), colour = \"red\") +\n  annotate(\"text\", x = as.Date(\"1992-01-01\"), y = 16, label = \"1990 Clean Air Act \\nammendments signed\", hjust = 0) +\n  theme_flynn() +\n  labs(title = \"Sulfate levels in Adirondack lakes, 1984-2016\",\n       subtitle = \"Public policy can help to mitigate or even reverse problems resulting from pollution\",\n       y = \"Sulfate Concentration (mg/L)\",\n       caption = \"Data obtained from the Adirondack Lakes Survey Corporation: \\n http://www.adirondacklakessurvey.org/data/complete/1992-2016_ALTM_Chemistry.zip \\nhttp://www.adirondacklakessurvey.org/data/sumsurf/sumsurf_chem/ALS_Summer_surface_chem_1984-87.zip \\nGraph depicts surface sample values only.\") +\n  scale_x_date(breaks = seq(as.Date(\"1984-01-01\"), as.Date(\"2017-01-01\"), by = \"4 years\"), \n                            labels = date_format(\"%b %Y\"),\n               limits = c(as.Date(\"1984-01-01\"), as.Date(\"2017-01-01\")))\n\n\n```\n\n\nMapping temperature anomalies over time.\n\n```{r tempoerature anomalies, warning=FALSE, echo=FALSE, message=FALSE}\n\ndata.temp.anom <- read.csv(here::here(\"../../Data Files/NOAA Data/1880-2016.csv\"), skip = 3) %>% \n  mutate(group = ifelse(Value > 0, \"Positive\", \"Negative\"))\n\nggplot(data = data.temp.anom, aes(x = Year, y = Value)) +\n  geom_hline(yintercept = 0, colour = \"red\") +\n  geom_line() +\n  geom_smooth(span = 1) +\n  theme_flynn() +\n  scale_x_continuous(breaks = seq(1880, 2020, 20)) +\n  scale_y_continuous(breaks = seq(-0.5, 1, .25)) +\n  labs(title = \"Global surface and ocean temperature anomalies, 1880-2016\",\n       subtitle = \"Temperature anomalies have been consistently positive since the 1980s\",\n       caption = \"Anomalies relative to the average for the 1900-2000 period average.\n       Data obtained from: NOAA National Centers for Environmental Information, Climate at a Glance: Global Time Series, published November 2016\n       Retrieved on December 1, 2016 from http://www.ncdc.noaa.gov/cag/\")\n```\n\n\nLonger term ice core temperature data and CO2 levels.\n\n```{r long term ice core and temp data, warning=FALSE, message=FALSE, echo=FALSE}\n\ndata.temp.anom <- read_csv(here(\"../../Data Files/NOAA Data/1880-2016.csv\"), skip = 3) %>% \n  mutate(group = ifelse(Value > 0, \"Positive\", \"Negative\"))\n\ndata.temp <- readxl::read_xls(here(\"../../Data Files/US Government Files/EPA/vostok.1999.temp.dat.xls\"), skip = 0)\ncolnames(data.temp)[2] <- \"time\"\ncolnames(data.temp)[4] <- \"temp\"\ndata.temp <- data.temp %>% \n  mutate(time = as.numeric(0 - time),\n         value = as.numeric(temp),\n         group = as.factor(\"Temp\")) %>% \n  subset(select = c(\"time\", \"value\", \"group\"))\n\n\n# Time variable had to be converted from factor to numeric\n# Have to use paste function\ndata.ice <- read_csv(here(\"../../Data Files/US Government Files/EPA/ghg-concentrations_fig-1.csv\"), skip = 7)\ncolnames(data.ice)[1] <- \"time\"\ndata.ice <- data.ice %>% \n  mutate(co2 = apply(., 1, max, na.rm = TRUE),\n         time = as.numeric(paste(time)),\n         value = as.numeric(co2),\n         group = as.factor(\"CO2\")) %>% \n  subset(select = c(\"time\", \"group\", \"value\"))\n\ndata.combined <- rbind(data.ice, data.temp)\n\n\n# The second scale was tricky. You have to reverse what you do for the rescaling in the geom_line section\n# Also note that, since you multiply by 10 BEFORE adding 250, you have to divide by 10 and subtract 25\nggplot() +\n  geom_line(data = subset(data.combined, group == \"CO2\"), aes(x = time, y = value, group = group, colour = group)) +\n  geom_line(data = subset(data.combined, group == \"Temp\"), aes(x = time, y = ((value * 10) + 250), group = group, colour = group), alpha = .6) +\n  geom_hline(yintercept = 250) +\n  scale_y_continuous(breaks = seq(150, 400, 50), limits = c(150, 400), sec.axis = sec_axis(~./10 - 25, name = \"Temperature Anomaly (°C)\", breaks = seq(-10, 16, 2))) +\n  scale_x_continuous(breaks = seq(-800000, 0, 100000), labels = scales::comma) +\n  theme_flynn() +\n  theme(legend.position = \"bottom\",\n        panel.grid.major = element_line(colour = \"gray70\", size = .1),\n        panel.grid.minor = element_line(colour = \"gray80\", size = .1)) +\n  scale_color_brewer(palette = \"Set1\") +\n  labs(colour = \"Measure\",\n       title = \"Global temperature anamoly and atmospheric CO2 levels\",\n       subtitle = \"CO2 levels and temperature anomalies track one another closely over the last 400,000 years\",\n       y = \"CO2 (ppm)\",\n       x = \"Time\",\n       caption = \"Ice core temperature data obtained from:\n       http://cdiac.ess-dive.lbl.gov/ftp/trends/temp/vostok/vostok.1999.temp.dat\n       CO2 data obtained from: https://www.epa.gov/sites/production/files/2016-08/ghg-concentrations_fig-1.csv\n       Note: Temperature data ends 2000 years prior to present day.\") \n\n\n```\n\n```{r example-plot, echo=FALSE, message=FALSE, warning=FALSE}\nlibrary(tidyverse)\n\ndata <- tibble::tibble(x = rnorm(1e3, 0, 3),\n                       y = 2 * x^3)\n\nggplot(data, aes(x = x, y = y, color = abs(x), size = abs(-y))) +\n  geom_point() +\n  theme_minimal()\n\nggsave(here::here(\"files/images/sample-figure.jpg\"))\n```\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../styles.css"],"output-file":"dataviz.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.0.37","editor":"source","theme":"cosmo","mainfont":"roboto-light","title":"Data Visualization","image":"/files/images/sample-figure.jpg"},"extensions":{"book":{"multiFile":true}}}}}